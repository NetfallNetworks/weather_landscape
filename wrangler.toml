name = "weather-landscape-worker"
main = "src/index.py"
compatibility_date = "2025-01-10"
compatibility_flags = ["python_workers"]

# Bundle image files as Data modules so Python can access them
[[rules]]
type = "Data"
globs = ["**/*.bmp", "**/*.png", "**/*.jpg", "**/*.jpeg"]
fallthrough = true

# Cron Trigger - runs every 15 minutes to regenerate weather images
[triggers]
crons = ["*/15 * * * *"]

# R2 Bucket Binding - stores generated weather landscape images
[[r2_buckets]]
binding = "WEATHER_IMAGES"
bucket_name = "weather-landscapes"

# KV Namespace Binding - stores configuration and metadata
# Replace YOUR_KV_NAMESPACE_ID with the ID from: wrangler kv namespace create CONFIG
[[kv_namespaces]]
binding = "CONFIG"
id = "YOUR_KV_NAMESPACE_ID"

# Environment Variables (non-sensitive)
[vars]
DEFAULT_LAT = 30.4515
DEFAULT_LON = -97.7676
DEFAULT_ZIP = "78729"
IMAGE_WIDTH = 296
IMAGE_HEIGHT = 128

# Note: Sensitive variables should be set using wrangler secrets:
# wrangler secret put OWM_API_KEY
# These will be available in env but not visible in wrangler.toml
